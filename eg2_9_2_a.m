%% based on txtbk [Engineering Vibration, 4th Ed, Inman], example 2.9.1 (a) %%

%--------------------------------------------------------------------------
function v=f(t,x)
m=100; k=2000; k1=0; c=170; F0=1500; w=sqrt(k/m)/2.964;
v=[x(2); x(1).*-k/m+x(2).*-c/m + x(1)^3*k1/m + F0/m*cos(w*t)];
end

%--------------------------------------------------------------------------
function v=f1(t,x)
m=100; k=2000; k1=520; c=170; F0=1500; w=sqrt(k/m)/2.964;
v=[x(2); x(1).*-k/m+x(2).*-c/m + x(1)^3*k1/m + F0/m*cos(w*t)];
end

%--------------------------------------------------------------------------
clear all

x0=[0.01;0.1];
ts=[0 40];

[t,x]=ode45('f',ts,x0);
plot(t,x(:,1));
hold on

[t,x1]=ode45('f1',ts,x0);
plot(t,x1(:,1),'r');
hold off